!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e["web-stream-json-parser"]=t()}(this,function(){"use strict";function e(e){return e=e||Object.create(null),{on:function(t,n){if("function"!=typeof n)throw new Error("Handler is not a function");(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).slice().map(function(e){e(n)}),(e["*"]||[]).slice().map(function(e){e(t,n)})}}}function t(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(a,r){try{var s=t[a](r),o=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)});e(o)}return i("next")})}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){for(var t=Object.keys(r),n=0,i=t.length;n<i;n++){var a=t[n];if(r[a]===e)return a}return e&&"0x"+e.toString(16)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r={},s=r.START=17,o=r.TRUE1=33,c=r.TRUE2=34,u=r.TRUE3=35,h=r.FALSE1=49,f=r.FALSE2=50,d=r.FALSE3=51,g=r.FALSE4=52,m=r.NULL1=65,p=r.NULL3=66,v=r.NULL2=67,E=r.NUMBER1=81,b=r.NUMBER2=82,l=r.NUMBER3=83,x=r.NUMBER4=84,k=r.NUMBER5=85,w=r.NUMBER6=86,R=r.NUMBER7=87,y=r.NUMBER8=88,N=r.STRING1=97,S=r.STRING2=98,U=r.STRING3=99,T=r.STRING4=100,L=r.STRING5=101,C=r.STRING6=102;return function(){function r(){n(this,r),this.state=s,this.string=void 0,this.unicode=void 0,this.negative=void 0,this.magnatude=void 0,this.position=void 0,this.exponent=void 0,this.negativeExponent=void 0;var t=e();this.on=t.on,this.off=t.off,this.emit=t.emit}return a(r,[{key:"read",value:function(){function e(){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function e(){var t,n,i;return regeneratorRuntime.wrap(function(e){for(var a=this;;)switch(e.prev=e.next){case 0:return e.next=2,a.reader.read();case 2:if(t=e.sent,n=t.value,i=t.done,a._parse(n),!i){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,a.read();case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"charError",value:function(e,t){throw new Error("Unexpected "+JSON.stringify(String.fromCharCode(e[t]))+" at position "+t+" in state "+i(this.state))}},{key:"cancel",value:function(){this.reader&&this.reader.cancel()}},{key:"_parse",value:function(e){var t=this;if(e)for(var n=void 0,i=0;i<e.length;i++)switch(t.state){case s:switch(n=e[i]){case 123:t.emit("startObject");continue;case 125:t.emit("endObject");continue;case 91:t.emit("startArray");continue;case 93:t.emit("endArray");continue;case 58:t.emit("colon");continue;case 44:t.emit("comma");continue;case 116:t.state=o;continue;case 102:t.state=h;continue;case 110:t.state=m;continue;case 34:t.string="",t.state=N;continue;case 45:t.negative=!0,t.state=E;continue;case 48:t.magnatude=0,t.state=b;continue}if(n>48&&n<64){t.magnatude=n-48,t.state=l;continue}if(32===n||9===n||10===n||13===n)continue;t.charError(e,i);break;case N:switch(n=e[i]){case 34:t.emit("string",t.string),t.string=void 0,t.state=s;continue;case 92:t.state=S;continue}if(n>=32){t.string+=String.fromCharCode(n);continue}t.charError(e,i);break;case S:switch(n=e[i]){case 34:t.string+='"',t.state=N;continue;case 92:t.string+="\\",t.state=N;continue;case 47:t.string+="/",t.state=N;continue;case 98:t.string+="\b",t.state=N;continue;case 102:t.string+="\f",t.state=N;continue;case 110:t.string+="\n",t.state=N;continue;case 114:t.string+="\r",t.state=N;continue;case 116:t.string+="\t",t.state=N;continue;case 117:t.unicode="",t.state=U;continue}t.charError(e,i);break;case U:case T:case L:case C:if((n=e[i])>=48&&n<64||n>64&&n<=70||n>96&&n<=102){t.unicode+=String.fromCharCode(n),t.state++===C&&(t.string+=String.fromCharCode(parseInt(t.unicode,16)),t.unicode=void 0,t.state=N);continue}t.charError(e,i);break;case E:if(48===(n=e[i])){t.magnatude=0,t.state=b;continue}if(n>48&&n<64){t.magnatude=n-48,t.state=l;continue}t.charError(e,i);break;case b:switch(e[i]){case 46:t.position=.1,t.state=x;continue;case 101:case 69:t.exponent=0,t.state=w;continue}t.finish(),i--;continue;case l:switch(n=e[i]){case 46:t.position=.1,t.state=x;continue;case 101:case 69:t.exponent=0,t.state=w;continue}if(n>=48&&n<64){t.magnatude=10*t.magnatude+(n-48);continue}t.finish(),i--;continue;case x:if((n=e[i])>=48&&n<64){t.magnatude+=t.position*(n-48),t.position/=10,t.state=k;continue}t.charError(e,i);break;case k:if((n=e[i])>=48&&n<64){t.magnatude+=t.position*(n-48),t.position/=10;continue}if(101===n||69===n){t.exponent=0,t.state=w;continue}t.finish(),i--;continue;case w:if(43===(n=e[i])||45===n){45===n&&(t.negativeExponent=!0),t.state=R;continue}if(n>=48&&n<64){t.exponent=10*t.exponent+(n-48),t.state=y;continue}t.charError(e,i);break;case R:if((n=e[i])>=48&&n<64){t.exponent=10*t.exponent+(n-48),t.state=y;continue}t.charError(e,i);break;case y:if((n=e[i])>=48&&n<64){t.exponent=10*t.exponent+(n-48);continue}t.finish(),i--;continue;case o:if(114===e[i]){t.state=c;continue}t.charError(e,i);break;case c:if(117===e[i]){t.state=u;continue}t.charError(e,i);break;case u:if(101===e[i]){t.state=s,t.emit("boolean",!0);continue}t.charError(e,i);break;case h:if(97===e[i]){t.state=f;continue}t.charError(e,i);break;case f:if(108===e[i]){t.state=d;continue}t.charError(e,i);break;case d:if(115===e[i]){t.state=g;continue}t.charError(e,i);break;case g:if(101===e[i]){t.state=s,t.emit("boolean",!1);continue}t.charError(e,i);break;case m:if(117===e[i]){t.state=p;continue}t.charError(e,i);break;case p:if(108===e[i]){t.state=v;continue}t.charError(e,i);break;case v:if(108===e[i]){t.state=s,t.emit("null",null);continue}t.charError(e,i)}}},{key:"finish",value:function(){switch(this.state){case b:this.emit("number",0),this.state=s,this.magnatude=void 0,this.negative=void 0;break;case l:this.state=s,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.emit("number",this.magnatude),this.magnatude=void 0;break;case k:this.state=s,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.emit("number",this.negative?-this.magnatude:this.magnatude),this.magnatude=void 0,this.position=void 0;break;case y:this.negativeExponent&&(this.exponent=-this.exponent,this.negativeExponent=void 0),this.magnatude*=Math.pow(10,this.exponent),this.exponent=void 0,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.state=s,this.emit("number",this.magnatude),this.magnatude=void 0}if(this.state!==s)throw new Error("Unexpected end of input stream")}},{key:"parse",value:function(){function e(e){return n.apply(this,arguments)}var n=t(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(var n=this;;)switch(e.prev=e.next){case 0:return n.reader=t.getReader(),e.next=3,n.read();case 3:case"end":return e.stop()}},e,this)}));return e}()}]),r}()});
//# sourceMappingURL=index.umd.js.map